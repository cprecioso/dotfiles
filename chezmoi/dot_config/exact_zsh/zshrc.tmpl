#!/usr/bin/env zsh

# shellcheck source=./xdg-overrides.zsh
source "{{.chezmoi.config.destDir}}/.config/zsh/xdg-overrides.zsh"

# Initially disable the atuin shortcuts
export ATUIN_NOBIND="true"

# Antidote
# shellcheck source=../exact_antidote/check_update.zsh.tmpl
source "{{.chezmoi.config.destDir}}/.config/antidote/check_update.zsh"
# shellcheck source=/dev/null
source "{{.chezmoi.config.destDir}}/.local/state/antidote/zsh_plugins.zsh"

# Restore atuin ctrl+r shortcut, overriding the fzf one
bindkey '^r' _atuin_search_widget

# Use abbreviations in autosuggestions
# shellcheck disable=SC2206
ZSH_AUTOSUGGEST_STRATEGY=(abbreviations $ZSH_AUTOSUGGEST_STRATEGY)

# pitchfork
source <(pitchfork activate zsh)

# yazi
function y() {
	local tmp cwd
	tmp="$(mktemp -t "yazi-cwd.XXXXXX")"
	yazi "$@" --cwd-file="$tmp"
	IFS= read -r -d '' cwd <"$tmp"
	# shellcheck disable=SC2164
	[ -n "$cwd" ] && [ "$cwd" != "$PWD" ] && builtin cd -- "$cwd"
	rm -f -- "$tmp"
}

# `file` formula
export PATH="/opt/homebrew/opt/file-formula/bin:$PATH"

# Local bin
export PATH="{{.chezmoi.config.destDir}}/.local/bin:$PATH"

# Alias
alias www="python3 -m http.server"
alias tailscale="/Applications/Tailscale.app/Contents/MacOS/Tailscale"

# VS Code editor
export EDITOR="code --wait"
